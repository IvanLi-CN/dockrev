FROM rust:1.91-bookworm AS builder
WORKDIR /src

COPY Cargo.toml Cargo.lock ./
COPY crates ./crates

RUN cargo build -p dockrev-api --release

FROM debian:bookworm-slim
RUN apt-get update && apt-get install -y ca-certificates && rm -rf /var/lib/apt/lists/*
WORKDIR /app

COPY --from=builder /src/target/release/dockrev-api /usr/local/bin/dockrev-api

EXPOSE 50883
CMD ["/usr/local/bin/dockrev-api"]

